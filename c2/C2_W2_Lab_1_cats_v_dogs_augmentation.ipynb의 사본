{"cells":[{"cell_type":"markdown","metadata":{"id":"o-Y-qbgMygJg"},"source":["<a href=\"https://colab.research.google.com/github/https-deeplearning-ai/tensorflow-1-public/blob/master/C2/W2/ungraded_labs/C2_W2_Lab_1_cats_v_dogs_augmentation.ipynb\" target=\"_parent\"><img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a>"]},{"cell_type":"markdown","metadata":{"id":"gGxCD4mGHHjG"},"source":["# Ungraded Lab: Data Augmentation\n","\n","In the previous lessons, you saw that having a high training accuracy does not automatically mean having a good predictive model. It can still perform poorly on new data because it has overfit to the training set. In this lab, you will see how to avoid that using _data augmentation_. This increases the amount of training data by modifying the existing training data's properties. For example, in image data, you can apply different preprocessing techniques such as rotate, flip, shear, or zoom on your existing images so you can simulate other data that the model should also learn from. This way, the model would see more variety in the images during training so it will infer better on new, previously unseen data.\n","\n","Let's see how you can do this in the following sections."]},{"cell_type":"code","execution_count":1,"metadata":{"id":"WDm745IsygJj","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1662367006350,"user_tz":-540,"elapsed":57738,"user":{"displayName":"‍조성우[ 학부재학 / 산업경영공학부 ]","userId":"07929875586727967845"}},"outputId":"da6dcb21-d651-46b9-cfcd-5929bc742be9"},"outputs":[{"output_type":"stream","name":"stdout","text":["Reading package lists... Done\n","Building dependency tree       \n","Reading state information... Done\n","The following package was automatically installed and is no longer required:\n","  libnvidia-common-460\n","Use 'apt autoremove' to remove it.\n","The following packages will be REMOVED:\n","  libcudnn8-dev\n","The following held packages will be changed:\n","  libcudnn8\n","The following packages will be upgraded:\n","  libcudnn8\n","1 upgraded, 0 newly installed, 1 to remove and 18 not upgraded.\n","Need to get 420 MB of archives.\n","After this operation, 3,369 MB disk space will be freed.\n","Get:1 https://developer.download.nvidia.com/compute/cuda/repos/ubuntu1804/x86_64  libcudnn8 8.4.1.50-1+cuda11.6 [420 MB]\n","Fetched 420 MB in 12s (35.8 MB/s)\n","(Reading database ... 155685 files and directories currently installed.)\n","Removing libcudnn8-dev (8.0.5.39-1+cuda11.1) ...\n","(Reading database ... 155663 files and directories currently installed.)\n","Preparing to unpack .../libcudnn8_8.4.1.50-1+cuda11.6_amd64.deb ...\n","Unpacking libcudnn8 (8.4.1.50-1+cuda11.6) over (8.0.5.39-1+cuda11.1) ...\n","Setting up libcudnn8 (8.4.1.50-1+cuda11.6) ...\n"]}],"source":["# Install this package to use Colab's GPU for training\n","!apt install --allow-change-held-packages libcudnn8=8.4.1.50-1+cuda11.6"]},{"cell_type":"markdown","metadata":{"id":"kJJqX4DxcQs8"},"source":["## Baseline Performance\n","\n","You will start with a model that's very effective at learning `Cats vs Dogs` without data augmentation. It's similar to the previous models that you have used. Note that there are four convolutional layers with 32, 64, 128 and 128 convolutions respectively. The code is basically the same from the previous lab so we won't go over the details step by step since you've already seen it before.\n","\n","You will train only for 20 epochs to save time but feel free to increase this if you want."]},{"cell_type":"code","execution_count":2,"metadata":{"id":"zJZIF29-dIRv","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1662367006804,"user_tz":-540,"elapsed":457,"user":{"displayName":"‍조성우[ 학부재학 / 산업경영공학부 ]","userId":"07929875586727967845"}},"outputId":"7049ea3e-0fc3-44b3-9e20-d7b00c1e205b"},"outputs":[{"output_type":"stream","name":"stdout","text":["--2022-09-05 08:36:45--  https://storage.googleapis.com/tensorflow-1-public/course2/cats_and_dogs_filtered.zip\n","Resolving storage.googleapis.com (storage.googleapis.com)... 108.177.13.128, 172.217.193.128, 172.217.204.128, ...\n","Connecting to storage.googleapis.com (storage.googleapis.com)|108.177.13.128|:443... connected.\n","HTTP request sent, awaiting response... 200 OK\n","Length: 68606236 (65M) [application/zip]\n","Saving to: ‘cats_and_dogs_filtered.zip’\n","\n","cats_and_dogs_filte 100%[===================>]  65.43M   145MB/s    in 0.5s    \n","\n","2022-09-05 08:36:46 (145 MB/s) - ‘cats_and_dogs_filtered.zip’ saved [68606236/68606236]\n","\n"]}],"source":["# Download the dataset\n","!wget https://storage.googleapis.com/tensorflow-1-public/course2/cats_and_dogs_filtered.zip"]},{"cell_type":"code","execution_count":3,"metadata":{"id":"_DyUfCTgdwa8","executionInfo":{"status":"ok","timestamp":1662367007834,"user_tz":-540,"elapsed":1034,"user":{"displayName":"‍조성우[ 학부재학 / 산업경영공학부 ]","userId":"07929875586727967845"}}},"outputs":[],"source":["import os\n","import zipfile\n","\n","# Extract the archive\n","zip_ref = zipfile.ZipFile(\"./cats_and_dogs_filtered.zip\", 'r')\n","zip_ref.extractall(\"tmp/\")\n","zip_ref.close()\n","\n","# Assign training and validation set directories\n","base_dir = 'tmp/cats_and_dogs_filtered'\n","train_dir = os.path.join(base_dir, 'train')\n","validation_dir = os.path.join(base_dir, 'validation')\n","\n","# Directory with training cat pictures\n","train_cats_dir = os.path.join(train_dir, 'cats')\n","\n","# Directory with training dog pictures\n","train_dogs_dir = os.path.join(train_dir, 'dogs')\n","\n","# Directory with validation cat pictures\n","validation_cats_dir = os.path.join(validation_dir, 'cats')\n","\n","# Directory with validation dog pictures\n","validation_dogs_dir = os.path.join(validation_dir, 'dogs')"]},{"cell_type":"markdown","metadata":{"id":"Ub_BdOJIfZ_Q"},"source":["You will place the model creation inside a function so you can easily initialize a new one when you use data augmentation later in this notebook."]},{"cell_type":"code","execution_count":4,"metadata":{"id":"uWllK_Wad-Mx","executionInfo":{"status":"ok","timestamp":1662367010342,"user_tz":-540,"elapsed":2510,"user":{"displayName":"‍조성우[ 학부재학 / 산업경영공학부 ]","userId":"07929875586727967845"}}},"outputs":[],"source":["import tensorflow as tf\n","from tensorflow.keras.optimizers import RMSprop\n","\n","def create_model():\n","  '''Creates a CNN with 4 convolutional layers'''\n","  model = tf.keras.models.Sequential([\n","      tf.keras.layers.Conv2D(32, (3,3), activation='relu', input_shape=(150, 150, 3)),\n","      tf.keras.layers.MaxPooling2D(2, 2),\n","      tf.keras.layers.Conv2D(64, (3,3), activation='relu'),\n","      tf.keras.layers.MaxPooling2D(2,2),\n","      tf.keras.layers.Conv2D(128, (3,3), activation='relu'),\n","      tf.keras.layers.MaxPooling2D(2,2),\n","      tf.keras.layers.Conv2D(128, (3,3), activation='relu'),\n","      tf.keras.layers.MaxPooling2D(2,2),\n","      tf.keras.layers.Flatten(),\n","      tf.keras.layers.Dense(512, activation='relu'),\n","      tf.keras.layers.Dense(1, activation='sigmoid')\n","  ])\n","\n","  model.compile(loss='binary_crossentropy',\n","                optimizer=RMSprop(learning_rate=1e-4),\n","                metrics=['accuracy'])\n","  \n","  return model"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"MJPyDEzOqrKB","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1662367010342,"user_tz":-540,"elapsed":5,"user":{"displayName":"‍조성우[ 학부재학 / 산업경영공학부 ]","userId":"07929875586727967845"}},"outputId":"29431119-7cee-4d4b-d996-ed5cbd87405e"},"outputs":[{"output_type":"stream","name":"stdout","text":["Found 2000 images belonging to 2 classes.\n","Found 1000 images belonging to 2 classes.\n"]}],"source":["from tensorflow.keras.preprocessing.image import ImageDataGenerator\n","\n","# All images will be rescaled by 1./255\n","train_datagen = ImageDataGenerator(rescale=1./255)\n","test_datagen = ImageDataGenerator(rescale=1./255)\n","\n","# Flow training images in batches of 20 using train_datagen generator\n","train_generator = train_datagen.flow_from_directory(\n","        train_dir,  # This is the source directory for training images\n","        target_size=(150, 150),  # All images will be resized to 150x150\n","        batch_size=20,\n","        # Since we use binary_crossentropy loss, we need binary labels\n","        class_mode='binary')\n","\n","# Flow validation images in batches of 20 using test_datagen generator\n","validation_generator = test_datagen.flow_from_directory(\n","        validation_dir,\n","        target_size=(150, 150),\n","        batch_size=20,\n","        class_mode='binary')"]},{"cell_type":"code","execution_count":6,"metadata":{"id":"hdqUoF44esR3","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1662367256644,"user_tz":-540,"elapsed":177500,"user":{"displayName":"‍조성우[ 학부재학 / 산업경영공학부 ]","userId":"07929875586727967845"}},"outputId":"71df0a5f-5533-4eea-9f86-62a4c0e672ed"},"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/20\n","100/100 - 14s - loss: 0.6886 - accuracy: 0.5280 - val_loss: 0.6693 - val_accuracy: 0.6250 - 14s/epoch - 138ms/step\n","Epoch 2/20\n","100/100 - 8s - loss: 0.6625 - accuracy: 0.5885 - val_loss: 0.6458 - val_accuracy: 0.6350 - 8s/epoch - 84ms/step\n","Epoch 3/20\n","100/100 - 8s - loss: 0.6119 - accuracy: 0.6740 - val_loss: 0.6076 - val_accuracy: 0.6760 - 8s/epoch - 83ms/step\n","Epoch 4/20\n","100/100 - 8s - loss: 0.5670 - accuracy: 0.6930 - val_loss: 0.6039 - val_accuracy: 0.6600 - 8s/epoch - 83ms/step\n","Epoch 5/20\n","100/100 - 8s - loss: 0.5484 - accuracy: 0.7270 - val_loss: 0.5615 - val_accuracy: 0.7060 - 8s/epoch - 83ms/step\n","Epoch 6/20\n","100/100 - 8s - loss: 0.5292 - accuracy: 0.7310 - val_loss: 0.5676 - val_accuracy: 0.7050 - 8s/epoch - 83ms/step\n","Epoch 7/20\n","100/100 - 8s - loss: 0.5082 - accuracy: 0.7505 - val_loss: 0.5488 - val_accuracy: 0.7210 - 8s/epoch - 83ms/step\n","Epoch 8/20\n","100/100 - 8s - loss: 0.4852 - accuracy: 0.7680 - val_loss: 0.5655 - val_accuracy: 0.7060 - 8s/epoch - 83ms/step\n","Epoch 9/20\n","100/100 - 8s - loss: 0.4515 - accuracy: 0.7755 - val_loss: 0.5446 - val_accuracy: 0.7380 - 8s/epoch - 82ms/step\n","Epoch 10/20\n","100/100 - 8s - loss: 0.4321 - accuracy: 0.7980 - val_loss: 0.5257 - val_accuracy: 0.7330 - 8s/epoch - 83ms/step\n","Epoch 11/20\n","100/100 - 8s - loss: 0.4139 - accuracy: 0.8110 - val_loss: 0.5253 - val_accuracy: 0.7390 - 8s/epoch - 84ms/step\n","Epoch 12/20\n","100/100 - 8s - loss: 0.3891 - accuracy: 0.8280 - val_loss: 0.5190 - val_accuracy: 0.7420 - 8s/epoch - 85ms/step\n","Epoch 13/20\n","100/100 - 8s - loss: 0.3631 - accuracy: 0.8360 - val_loss: 0.5174 - val_accuracy: 0.7560 - 8s/epoch - 83ms/step\n","Epoch 14/20\n","100/100 - 8s - loss: 0.3396 - accuracy: 0.8570 - val_loss: 0.6222 - val_accuracy: 0.7100 - 8s/epoch - 83ms/step\n","Epoch 15/20\n","100/100 - 8s - loss: 0.3236 - accuracy: 0.8620 - val_loss: 0.5472 - val_accuracy: 0.7410 - 8s/epoch - 83ms/step\n","Epoch 16/20\n","100/100 - 8s - loss: 0.2995 - accuracy: 0.8725 - val_loss: 0.5098 - val_accuracy: 0.7520 - 8s/epoch - 82ms/step\n","Epoch 17/20\n","100/100 - 8s - loss: 0.2786 - accuracy: 0.8885 - val_loss: 0.5440 - val_accuracy: 0.7470 - 8s/epoch - 83ms/step\n","Epoch 18/20\n","100/100 - 8s - loss: 0.2608 - accuracy: 0.8965 - val_loss: 0.5487 - val_accuracy: 0.7550 - 8s/epoch - 82ms/step\n","Epoch 19/20\n","100/100 - 8s - loss: 0.2474 - accuracy: 0.8985 - val_loss: 0.5326 - val_accuracy: 0.7540 - 8s/epoch - 84ms/step\n","Epoch 20/20\n","100/100 - 8s - loss: 0.2258 - accuracy: 0.9170 - val_loss: 0.5625 - val_accuracy: 0.7560 - 8s/epoch - 84ms/step\n"]}],"source":["# Constant for epochs\n","EPOCHS = 20\n","\n","# Create a new model\n","model = create_model()\n","\n","# Train the model\n","history = model.fit(\n","      train_generator,\n","      steps_per_epoch=100,  # 2000 images = batch_size * steps\n","      epochs=EPOCHS,\n","      validation_data=validation_generator,\n","      validation_steps=50,  # 1000 images = batch_size * steps\n","      verbose=2)"]},{"cell_type":"markdown","metadata":{"id":"Y-G0Am4cguNt"},"source":["You will then visualize the loss and accuracy with respect to the training and validation set. You will again use a convenience function so it can be reused later. This function accepts a [History](https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/History) object which contains the results of the `fit()` method you ran above."]},{"cell_type":"code","execution_count":8,"metadata":{"id":"GZWPcmKWO303","executionInfo":{"status":"ok","timestamp":1662367268437,"user_tz":-540,"elapsed":4,"user":{"displayName":"‍조성우[ 학부재학 / 산업경영공학부 ]","userId":"07929875586727967845"}}},"outputs":[],"source":["import matplotlib.pyplot as plt\n","\n","def plot_loss_acc(history):\n","  '''Plots the training and validation loss and accuracy from a history object'''\n","  acc = history.history['accuracy']\n","  val_acc = history.history['val_accuracy']\n","  loss = history.history['loss']\n","  val_loss = history.history['val_loss']\n","\n","  epochs = range(len(acc))\n","\n","  plt.plot(epochs, acc, 'bo', label='Training accuracy')\n","  plt.plot(epochs, val_acc, 'b', label='Validation accuracy')\n","  plt.title('Training and validation accuracy')\n","\n","  plt.figure()\n","\n","  plt.plot(epochs, loss, 'bo', label='Training Loss')\n","  plt.plot(epochs, val_loss, 'b', label='Validation Loss')\n","  plt.title('Training and validation loss')\n","  plt.legend()\n","\n","  plt.show()"]},{"cell_type":"code","execution_count":9,"metadata":{"id":"Vojz4NYXiT_f","colab":{"base_uri":"https://localhost:8080/","height":545},"executionInfo":{"status":"ok","timestamp":1662367272430,"user_tz":-540,"elapsed":447,"user":{"displayName":"‍조성우[ 학부재학 / 산업경영공학부 ]","userId":"07929875586727967845"}},"outputId":"1bf40c61-5955-4aab-ca3a-b320fda897aa"},"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}},{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"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O+9PnDiRF0prk62kmjrNbsYl9GKHHgqvvBJq6EuWQM+eoeb+ww+pjkwku4wYMYIZM2bstmzGjBkxz6cyZ86cKg/OKZnQJ0+ezHHHHVeldaWDjE3oEA6ajhkTDpoOHx7ay8s6aCoiiTFs2DCeeeaZnSezWL16NZ999hlHHXUU48ePJzc3ly5dunD99deX+vx27dqxYcMGAKZMmULHjh058sgjd06xC6GPeZ8+fejRowennXYaW7du5Y033mD27Nn84Q9/oGfPnnzyySeMHj2axx57DAgjQg877DC6devGmDFj+PHHH3du7/rrr6dXr15069aN5cuXx/xaUz3NbtoN/a+KFi3g//4PRo0KfddPOAEeeADOOSfVkYkk12WXweLF8V1nz57w17+W/fh+++1H3759mTt3LkOHDmXGjBmcccYZmBlTpkxhv/32o7CwkGOPPZb333+f7t27l7qed955hxkzZrB48WIKCgro1asXvXv3BuDUU0/l/PPPB+Daa6/l3nvv5eKLL+bkk0/mpJNOYtiwYbuta9u2bYwePZoXX3yRjh07cs455/C3v/2Nyy67DIBmzZqxaNEi7rrrLm677TbuueeeCvdDTZhmN6Nr6CUde2w4aHrssXDuufDww6mOSCQ7RDe7RDe3zJw5k169enHYYYexdOnS3ZpHSnrttdc45ZRTaNCgAXvvvTcnn7zrlMZLlizhqKOOolu3buTl5ZU5/W6xjz76iPbt29OxY0cARo0axfz583c+fuqppwLQu3fvnRN6VaQmTLObFTX0aHvtBf/8JwwZEro21qkDp5+e6qhEkqO8mnQiDR06lMsvv5xFixaxdetWevfuzaeffsptt93GggULaNKkCaNHjy5z2tyKjB49mlmzZtGjRw8eeOABXnnllWrFWzwFbzym3y2eZnfevHlMnTqVmTNnct999/HMM88wf/58nnrqKaZMmcIHH3xQ7cSeVTX0Yg0awFNPQf/+MGIEPPlkqiMSyWyNGjVi4MCBjBkzZmftfPPmzTRs2JB99tmHL7/8krlz55a7jqOPPppZs2bxww8/sGXLFp566qmdj23ZsoUDDjiAHTt2kBc1QVPjxo3ZsmXLHus65JBDWL16NStXrgTgoYce4phjjqnWa6wJ0+xmXQ29WKNGMGcO/OIXYZTp44/DL3+Z6qhEMteIESM45ZRTdja99OjR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\n"},"metadata":{"needs_background":"light"}}],"source":["# Plot training results\n","plot_loss_acc(history)"]},{"cell_type":"markdown","metadata":{"id":"zb81GvNov-Tg"},"source":["From the results above, you'll see the training accuracy is more than 90%, and the validation accuracy is in the 70%-80% range. This is a great example of _overfitting_ -- which in short means that it can do very well with images it has seen before, but not so well with images it hasn't.\n"]},{"cell_type":"markdown","metadata":{"id":"5KBz-vFbjLZX"},"source":["## Data augmentation\n","\n","One simple method to avoid overfitting is to augment the images a bit. If you think about it, most pictures of a cat are very similar -- the ears are at the top, then the eyes, then the mouth etc. Things like the distance between the eyes and ears will always be quite similar too. \n","\n","What if you tweak with the images a bit -- rotate the image, squash it, etc.  That's what image augementation is all about. And there's an API that makes it easy!\n","\n","Take a look at the [ImageDataGenerator](https://www.tensorflow.org/api_docs/python/tf/keras/preprocessing/image/ImageDataGenerator) which you have been using to rescale the image. There are other properties on it that you can use to augment the image. \n","\n","```\n","# Updated to do image augmentation\n","train_datagen = ImageDataGenerator(\n","      rotation_range=40,\n","      width_shift_range=0.2,\n","      height_shift_range=0.2,\n","      shear_range=0.2,\n","      zoom_range=0.2,\n","      horizontal_flip=True,\n","      fill_mode='nearest')\n","```\n","\n","These are just a few of the options available. Let's quickly go over it:\n","\n","* `rotation_range` is a value in degrees (0–180) within which to randomly rotate pictures.\n","* `width_shift` and `height_shift` are ranges (as a fraction of total width or height) within which to randomly translate pictures vertically or horizontally.\n","* `shear_range` is for randomly applying shearing transformations.\n","* `zoom_range` is for randomly zooming inside pictures.\n","* `horizontal_flip` is for randomly flipping half of the images horizontally. This is relevant when there are no assumptions of horizontal assymmetry (e.g. real-world pictures).\n","* `fill_mode` is the strategy used for filling in newly created pixels, which can appear after a rotation or a width/height shift.\n","\n","\n","Run the next cells to see the impact on the results. The code is similar to the baseline but the definition of `train_datagen` has been updated to use the parameters described above.\n"]},{"cell_type":"code","execution_count":10,"metadata":{"id":"UK7_Fflgv8YC","colab":{"base_uri":"https://localhost:8080/","height":780},"executionInfo":{"status":"error","timestamp":1662367488857,"user_tz":-540,"elapsed":199793,"user":{"displayName":"‍조성우[ 학부재학 / 산업경영공학부 ]","userId":"07929875586727967845"}},"outputId":"d3286c43-4b8e-4703-db80-3ef61334ccb5"},"outputs":[{"output_type":"stream","name":"stdout","text":["Found 2000 images belonging to 2 classes.\n","Found 1000 images belonging to 2 classes.\n","Epoch 1/20\n","100/100 - 17s - loss: 0.6913 - accuracy: 0.5260 - val_loss: 0.7007 - val_accuracy: 0.5000 - 17s/epoch - 175ms/step\n","Epoch 2/20\n","100/100 - 17s - loss: 0.6731 - accuracy: 0.5745 - val_loss: 0.7369 - val_accuracy: 0.5030 - 17s/epoch - 165ms/step\n","Epoch 3/20\n","100/100 - 17s - loss: 0.6623 - accuracy: 0.5975 - val_loss: 0.6226 - val_accuracy: 0.6550 - 17s/epoch - 166ms/step\n","Epoch 4/20\n","100/100 - 17s - loss: 0.6419 - accuracy: 0.6245 - val_loss: 0.5911 - val_accuracy: 0.7060 - 17s/epoch - 166ms/step\n","Epoch 5/20\n","100/100 - 17s - loss: 0.6278 - accuracy: 0.6330 - val_loss: 0.5733 - val_accuracy: 0.6990 - 17s/epoch - 165ms/step\n","Epoch 6/20\n","100/100 - 17s - loss: 0.6055 - accuracy: 0.6705 - val_loss: 0.6058 - val_accuracy: 0.6500 - 17s/epoch - 166ms/step\n","Epoch 7/20\n","100/100 - 17s - loss: 0.6052 - accuracy: 0.6505 - val_loss: 0.5798 - val_accuracy: 0.6790 - 17s/epoch - 166ms/step\n","Epoch 8/20\n","100/100 - 17s - loss: 0.5953 - accuracy: 0.6790 - val_loss: 0.5650 - val_accuracy: 0.7050 - 17s/epoch - 166ms/step\n","Epoch 9/20\n","100/100 - 16s - loss: 0.5865 - accuracy: 0.6880 - val_loss: 0.5487 - val_accuracy: 0.7100 - 16s/epoch - 165ms/step\n","Epoch 10/20\n","100/100 - 16s - loss: 0.5835 - accuracy: 0.6895 - val_loss: 0.5300 - val_accuracy: 0.7280 - 16s/epoch - 165ms/step\n","Epoch 11/20\n","100/100 - 16s - loss: 0.5809 - accuracy: 0.6870 - val_loss: 0.5284 - val_accuracy: 0.7410 - 16s/epoch - 165ms/step\n","Epoch 12/20\n"]},{"output_type":"error","ename":"KeyboardInterrupt","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m<ipython-input-10-31d799fea8a4>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m     38\u001b[0m       \u001b[0mvalidation_data\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mvalidation_generator\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     39\u001b[0m       \u001b[0mvalidation_steps\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m50\u001b[0m\u001b[0;34m,\u001b[0m  \u001b[0;31m# 1000 images = batch_size * steps\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 40\u001b[0;31m       verbose=2)\n\u001b[0m","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/keras/utils/traceback_utils.py\u001b[0m in \u001b[0;36merror_handler\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m     62\u001b[0m     \u001b[0mfiltered_tb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     63\u001b[0m     \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 64\u001b[0;31m       \u001b[0;32mreturn\u001b[0m \u001b[0mfn\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     65\u001b[0m     \u001b[0;32mexcept\u001b[0m \u001b[0mException\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m  \u001b[0;31m# pylint: disable=broad-except\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     66\u001b[0m       \u001b[0mfiltered_tb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0m_process_traceback_frames\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0me\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__traceback__\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/keras/engine/training.py\u001b[0m in \u001b[0;36mfit\u001b[0;34m(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_batch_size, validation_freq, max_queue_size, workers, use_multiprocessing)\u001b[0m\n\u001b[1;32m   1429\u001b[0m               \u001b[0muse_multiprocessing\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0muse_multiprocessing\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1430\u001b[0m               \u001b[0mreturn_dict\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1431\u001b[0;31m               _use_cached_eval_dataset=True)\n\u001b[0m\u001b[1;32m   1432\u001b[0m           \u001b[0mval_logs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m{\u001b[0m\u001b[0;34m'val_'\u001b[0m \u001b[0;34m+\u001b[0m \u001b[0mname\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mval\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mname\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mval\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mval_logs\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mitems\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1433\u001b[0m           \u001b[0mepoch_logs\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mupdate\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mval_logs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/keras/utils/traceback_utils.py\u001b[0m in \u001b[0;36merror_handler\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m     62\u001b[0m     \u001b[0mfiltered_tb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     63\u001b[0m     \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 64\u001b[0;31m       \u001b[0;32mreturn\u001b[0m \u001b[0mfn\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     65\u001b[0m     \u001b[0;32mexcept\u001b[0m \u001b[0mException\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m  \u001b[0;31m# pylint: disable=broad-except\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     66\u001b[0m       \u001b[0mfiltered_tb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0m_process_traceback_frames\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0me\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__traceback__\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/keras/engine/training.py\u001b[0m in \u001b[0;36mevaluate\u001b[0;34m(self, x, y, batch_size, verbose, sample_weight, steps, callbacks, max_queue_size, workers, use_multiprocessing, return_dict, **kwargs)\u001b[0m\n\u001b[1;32m   1714\u001b[0m             \u001b[0;32mwith\u001b[0m \u001b[0mtf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mprofiler\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mexperimental\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mTrace\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'test'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mstep_num\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mstep\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0m_r\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1715\u001b[0m               \u001b[0mcallbacks\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mon_test_batch_begin\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mstep\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1716\u001b[0;31m               \u001b[0mtmp_logs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtest_function\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0miterator\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1717\u001b[0m               \u001b[0;32mif\u001b[0m \u001b[0mdata_handler\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshould_sync\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1718\u001b[0m                 \u001b[0mcontext\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0masync_wait\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/tensorflow/python/util/traceback_utils.py\u001b[0m in \u001b[0;36merror_handler\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m    148\u001b[0m     \u001b[0mfiltered_tb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    149\u001b[0m     \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 150\u001b[0;31m       \u001b[0;32mreturn\u001b[0m \u001b[0mfn\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    151\u001b[0m     \u001b[0;32mexcept\u001b[0m \u001b[0mException\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    152\u001b[0m       \u001b[0mfiltered_tb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0m_process_traceback_frames\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0me\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__traceback__\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, *args, **kwds)\u001b[0m\n\u001b[1;32m    913\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    914\u001b[0m       \u001b[0;32mwith\u001b[0m \u001b[0mOptionalXlaContext\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_jit_compile\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 915\u001b[0;31m         \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_call\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwds\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    916\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    917\u001b[0m       \u001b[0mnew_tracing_count\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mexperimental_get_tracing_count\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/def_function.py\u001b[0m in \u001b[0;36m_call\u001b[0;34m(self, *args, **kwds)\u001b[0m\n\u001b[1;32m    952\u001b[0m       \u001b[0;31m# In this case we have not created variables on the first call. So we can\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    953\u001b[0m       \u001b[0;31m# run the first trace but we should fail if variables are created.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 954\u001b[0;31m       \u001b[0mresults\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_stateful_fn\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwds\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    955\u001b[0m       \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_created_variables\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mALLOW_DYNAMIC_VARIABLE_CREATION\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    956\u001b[0m         raise ValueError(\"Creating variables on a non-first call to a function\"\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   2955\u001b[0m        filtered_flat_args) = self._maybe_define_function(args, kwargs)\n\u001b[1;32m   2956\u001b[0m     return graph_function._call_flat(\n\u001b[0;32m-> 2957\u001b[0;31m         filtered_flat_args, captured_inputs=graph_function.captured_inputs)  # pylint: disable=protected-access\n\u001b[0m\u001b[1;32m   2958\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2959\u001b[0m   \u001b[0;34m@\u001b[0m\u001b[0mproperty\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py\u001b[0m in \u001b[0;36m_call_flat\u001b[0;34m(self, args, captured_inputs, cancellation_manager)\u001b[0m\n\u001b[1;32m   1852\u001b[0m       \u001b[0;31m# No tape is watching; skip to running the function.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1853\u001b[0m       return self._build_call_outputs(self._inference_function.call(\n\u001b[0;32m-> 1854\u001b[0;31m           ctx, args, cancellation_manager=cancellation_manager))\n\u001b[0m\u001b[1;32m   1855\u001b[0m     forward_backward = self._select_forward_and_backward_functions(\n\u001b[1;32m   1856\u001b[0m         \u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/function.py\u001b[0m in \u001b[0;36mcall\u001b[0;34m(self, ctx, args, cancellation_manager)\u001b[0m\n\u001b[1;32m    502\u001b[0m               \u001b[0minputs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    503\u001b[0m               \u001b[0mattrs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mattrs\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 504\u001b[0;31m               ctx=ctx)\n\u001b[0m\u001b[1;32m    505\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    506\u001b[0m           outputs = execute.execute_with_cancellation(\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/execute.py\u001b[0m in \u001b[0;36mquick_execute\u001b[0;34m(op_name, num_outputs, inputs, attrs, ctx, name)\u001b[0m\n\u001b[1;32m     53\u001b[0m     \u001b[0mctx\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mensure_initialized\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     54\u001b[0m     tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,\n\u001b[0;32m---> 55\u001b[0;31m                                         inputs, attrs, num_outputs)\n\u001b[0m\u001b[1;32m     56\u001b[0m   \u001b[0;32mexcept\u001b[0m \u001b[0mcore\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_NotOkStatusException\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     57\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mname\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mKeyboardInterrupt\u001b[0m: "]}],"source":["# Create new model\n","model_for_aug = create_model()\n","\n","# This code has changed. Now instead of the ImageGenerator just rescaling\n","# the image, we also rotate and do other operations\n","train_datagen = ImageDataGenerator(\n","      rescale=1./255,\n","      rotation_range=40,\n","      width_shift_range=0.2,\n","      height_shift_range=0.2,\n","      shear_range=0.2,\n","      zoom_range=0.2,\n","      horizontal_flip=True,\n","      fill_mode='nearest')\n","\n","test_datagen = ImageDataGenerator(rescale=1./255)\n","\n","# Flow training images in batches of 20 using train_datagen generator\n","train_generator = train_datagen.flow_from_directory(\n","        train_dir,  # This is the source directory for training images\n","        target_size=(150, 150),  # All images will be resized to 150x150\n","        batch_size=20,\n","        # Since we use binary_crossentropy loss, we need binary labels\n","        class_mode='binary')\n","\n","# Flow validation images in batches of 20 using test_datagen generator\n","validation_generator = test_datagen.flow_from_directory(\n","        validation_dir,\n","        target_size=(150, 150),\n","        batch_size=20,\n","        class_mode='binary')\n","\n","# Train the new model\n","history_with_aug = model_for_aug.fit(\n","      train_generator,\n","      steps_per_epoch=100,  # 2000 images = batch_size * steps\n","      epochs=EPOCHS,\n","      validation_data=validation_generator,\n","      validation_steps=50,  # 1000 images = batch_size * steps\n","      verbose=2)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bnyRnwopT5aW"},"outputs":[],"source":["# Plot the results of training with data augmentation\n","plot_loss_acc(history_with_aug)"]},{"cell_type":"markdown","metadata":{"id":"1D1hd5fqmJUx"},"source":["As you can see, the training accuracy has gone down compared to the baseline. This is expected because (as a result of data augmentation) there are more variety in the images so the model will need more runs to learn from them. The good thing is the validation accuracy is no longer stalling and is more in line with the training results. This means that the model is now performing better on unseen data. \n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"z4B9b6GPnKg1"},"source":["## Wrap Up\n","\n","This exercise showed a simple trick to avoid overfitting. You can improve your baseline results by simply tweaking the same images you have already. The `ImageDataGenerator` class has built-in parameters to do just that. Try to modify the values some more in the `train_datagen` and see what results you get.\n","\n","Take note that this will not work for all cases. In the next lesson, Laurence will show a scenario where data augmentation will not help improve your validation accuracy."]}],"metadata":{"accelerator":"GPU","colab":{"collapsed_sections":[],"provenance":[{"file_id":"https://github.com/https-deeplearning-ai/tensorflow-1-public/blob/master/C2/W2/ungraded_labs/C2_W2_Lab_1_cats_v_dogs_augmentation.ipynb","timestamp":1662366913285},{"file_id":"https://github.com/https-deeplearning-ai/tensorflow-1-public/blob/adding_C2/C2/W2/ungraded_labs/C2_W2_Lab_1_cats_v_dogs_augmentation.ipynb","timestamp":1639637705486}]},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.7.4"},"gpuClass":"standard"},"nbformat":4,"nbformat_minor":0}